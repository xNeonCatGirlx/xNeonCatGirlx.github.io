<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Synthwave Rain ✨</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Honk&family=Rajdhani:wght@700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
  <link rel="stylesheet" href="./style.css">
  <style>
    .walls {
      height: 100vh;
      width: 100vw;
      position: relative;
      overflow: hidden;
    }
    .wall {
      position: absolute;
      inset: 0;
      display: flex;
      gap: 1rem;
      pointer-events: none;
    }
    .column {
      display: flex;
      flex-direction: column-reverse;
      transform: translateY(-120vh);
      animation-name: fall;
      animation-timing-function: ease-in-out;
      animation-fill-mode: forwards;
    }
    @keyframes fall {
      to {
        transform: translateY(2vh);
        opacity: 0;
      }
    }
  </style>
</head>
<body>
  <div class="walls"></div>
  <script>
    const kanas = ['ﾆ','ﾜ','ﾒ','ｼ','ｻ','ﾘ','ｳ','ﾗ','ｵ','ｴ','ｱ','ｾ','ﾊ','ｹ','ｰ','ﾃ','ｷ','ﾋ','ﾍ','ﾑ','ﾕ','ｽ','ﾏ'];
    const walls = document.querySelector('.walls');
    const numWalls = 3;
    const maxColumnsOnScreen = 10;
    const dropsPerVariant = 15;
    const variantsPerColumn = 2;
    const durationMin = 6;
    const durationMax = 12;

    function randKana() {
      return kanas[Math.floor(Math.random() * kanas.length)];
    }

    function spawnColumn(wall) {
      const column = document.createElement('div');
      column.className = 'column';

      const duration = (Math.random() * (durationMax - durationMin) + durationMin).toFixed(2);
      column.style.animationDuration = `${duration}s`;

      for (let v = 0; v < variantsPerColumn; v++) {
        const variant = document.createElement('div');
        variant.className = 'variant';

        for (let d = 0; d < dropsPerVariant; d++) {
          const drop = document.createElement('div');
          drop.className = 'drop';
          drop.textContent = randKana();
          variant.appendChild(drop);
        }

        column.appendChild(variant);
      }

      wall.appendChild(column);

      setTimeout(() => column.remove(), duration * 1000);
    }

    for (let w = 0; w < numWalls; w++) {
      const wall = document.createElement('div');
      wall.className = 'wall';
      wall.style.setProperty('--wi', w - 3);
      walls.appendChild(wall);

      setInterval(() => {
        if (wall.children.length < maxColumnsOnScreen) {
          spawnColumn(wall);
        }
      }, 500);
    }
  </script>
</body>
</html>
